#!/bin/sh

# pyominas setup script for Linux VM. Currently set to work with my installed
# directories, but the script could be rewritten to search for the necessary
# locations prior to adjusting environment varibles and launching python

# ominas environment variables
. ~/.ominas/ominas_setup.sh

# find pyomninas directory
if [ "$PYOMINAS_DIR" = "" ]; then
    # OMINAS_DIR environemtn variable from ominas_setup.sh
    for DIR in $OMINAS_DIR; do
      if [ -d $DIR ]; then
          if [ -f $DIR/ominas.py ]; then
              IDL_DIR=$DIR
          break
          fi
      fi
    done
fi

if [ "$PYOMINAS_DIR" = "" ]; then
    echo "Unable to access the pyominas directory. You will have to
define the PYOMINAS_DIR environment variable to point at the main
pyominas directory before it will work."
    exit 1
fi

# configure PYTHONSTARTUP
APPLICATION=python
MODULES=pyominas_setup.py
export PYTHONSTARTUP=$MODULES

# linux bridge environment variables
export LD_LIBRARY_PATH="/data/software/anaconda2/lib/:/usr/local/exelis/idl85/bin/bin.linux.x86_64"
export PYTHONPATH="/usr/local/exelis/idl85/bin/bin.linux.x86_64:/usr/local/exelis/idl85/lib/bridges"
export PATH="/data/software/anaconda2/bin:$PATH" # Ideally, find activate and source it.

# launch python
$APPLICATION $@ # pass arguments
